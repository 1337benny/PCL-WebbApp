@model Checklist

<h2>Fyll i checklista: @Model.Name</h2>

<div>
    <table class="table table-bordered table-striped" style="width: 100%; table-layout: fixed;">
        <thead>
            <tr>
                
                <th style="width: 30%; text-align: left; vertical-align: middle;">Kund</th>
                <th style="width: 10%; text-align: left; vertical-align: middle;">Stad</th>
                <th style="width: 30%; text-align: left; vertical-align: middle;">Epost</th>
            </tr>
        </thead>
        <tbody>
           <td>@Model.ProjectHasChecklists.FirstOrDefault().Project.ClientHasProjects.FirstOrDefault().Client.Name</td>
        <td>@Model.ProjectHasChecklists.FirstOrDefault().Project.ClientHasProjects.FirstOrDefault().Client.City</td>
        <td>@Model.ProjectHasChecklists.FirstOrDefault().Project.ClientHasProjects.FirstOrDefault().Client.Email</td>
        </tbody>
    </table>
</div>


<div class="p-1 m-1">
    <label>Bedömningar:</label>
    <p><span class="fw-bold">(X)</span> = Klar utan anmärkning.
    <span class="fw-bold">(1)</span> = Bör åtgärdas.
    <span class="fw-bold">(2)</span> = Skall åtgärdas.
    <span class="fw-bold">(Å)</span> = Åtgärdat.
    <span class="fw-bold">(-)</span> = Ej tillämligt.</p>
</div>



@{
    var tasks = Model.ListTasks.ToList(); // Gör om IEnumerable till en lista
}

<form asp-action="UpdateProjectChecklist" method="post">
    <input type="hidden" asp-for="Id" />

    <table class="table table-bordered table-striped" style="width: 100%; table-layout: fixed;">
        <thead>
            <tr>
                <th style="width: 5%; text-align: left; vertical-align: middle;">Bed.</th>
                <th style="width: 25%; text-align: left; vertical-align: middle;">Uppgift</th>
                <th style="width: 30%; text-align: left; vertical-align: middle;">Beskrivning</th>
                <th style="width: 10%; text-align: left; vertical-align: middle;">Status</th>
                <th style="width: 30%; text-align: left; vertical-align: middle;">Notering</th>
            </tr>
        </thead>
        <tbody>
            @for (var i = 0; i < tasks.Count; i++)
            {
                var assessment = tasks[i].Assessment ?? "-"; // Standardvärde om Assessment är null
                var isCompleted = tasks[i].IsCompleted.ToString().ToLower();

                <tr>
                    <input type="hidden" name="ListTasks[@i].Id" value="@tasks[i].Id" />

                    <td>
                        <select name="ListTasks[@i].Assessment" class="form-control" style="width: 100%;">
                            <option value="X" selected="@(assessment == "X")">X</option>
                            <option value="1" selected="@(assessment == "1")">1</option>
                            <option value="2" selected="@(assessment == "2")">2</option>
                            <option value="Å" selected="@(assessment == "Å")">Å</option>
                            <option value="-" selected="@(assessment == "-")">-</option>
                        </select>
                    </td>
                    <td style="vertical-align: middle;">@tasks[i].Name</td>
                    <td style="vertical-align: middle;">@tasks[i].Description</td>
                    <td>
                        <select name="ListTasks[@i].IsCompleted" class="form-control" style="width: 100%;">
                            <option value="true" selected="@(isCompleted == "true")">Klar</option>
                            <option value="false" selected="@(isCompleted == "false")">Ej Klar</option>
                        </select>
                    </td>
                    <td>
                        <textarea name="ListTasks[@i].Note" class="form-control" style="width: 100%; resize: none;" rows="3">@tasks[i].Note</textarea>
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <button type="submit" class="btn btn-primary mt-3">Spara</button>
</form>

<button id="save-pdf" class="btn btn-success">Spara som PDF</button>

